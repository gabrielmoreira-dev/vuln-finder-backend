const toLM = vulnerabilityRM => {
  return {
    summary: vulnerabilityRM.entry.details.affected,
    impact: vulnerabilityRM.entry.details.impact,
    countermeasure: vulnerabilityRM.entry.details.countermeasure,
    risk: vulnerabilityRM.vulnerability.risk.name
  }
}

module.exports = data => {
  const { result } = data
  if (!result) {
    return null
  }
  if (Array.isArray(result)) {
    return result.map(toLM)
  }
  return toLM(result)
}